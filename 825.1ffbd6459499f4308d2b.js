(self.webpackChunktpa_info_app=self.webpackChunktpa_info_app||[]).push([[825],{9825:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ManageCompaniesModule:()=>w});var a=n(1116),o=n(9272),r=n(1462),i=n(1858),s=n(5366),c=n(4501);let d=(()=>{class t{generateId(){let t="";const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=e.length;for(var a=0;a<20;a++)t+=e.charAt(Math.floor(Math.random()*n));return t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function p(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",15),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw().confirmToDelete("company",e)}),s._uU(1,"X"),s.qZA()}}function m(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",15),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit,n=s.oxw().$implicit;return s.oxw().confirmToDelete("tab",n,e.id,e.tabName)}),s._uU(1,"X"),s.qZA()}}function u(t,e){if(1&t&&(s.TgZ(0,"article",16),s.TgZ(1,"article"),s._uU(2),s.qZA(),s.YNc(3,m,2,0,"button",10),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.xp6(2),s.hij(" ",t.tabName," "),s.xp6(1),s.Q6J("ngIf",n.isInEditMode)}}function l(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"article",8),s.TgZ(1,"article",9),s.TgZ(2,"article"),s._uU(3),s.qZA(),s.YNc(4,p,2,0,"button",10),s.qZA(),s.TgZ(5,"article",11),s.YNc(6,u,4,2,"article",12),s.qZA(),s.TgZ(7,"article",13),s.TgZ(8,"button",14),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().edit(e)}),s._uU(9,"Edit"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,n=s.oxw();s.xp6(3),s.hij(" ",t.name," "),s.xp6(1),s.Q6J("ngIf",n.isInEditMode),s.xp6(2),s.Q6J("ngForOf",t.tabs)}}function b(t,e){1&t&&(s.TgZ(0,"article"),s.TgZ(1,"p"),s._uU(2,"No records added"),s.qZA(),s.qZA())}function h(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",39),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().index;return s.oxw(2).deleteTab(e)}),s._uU(1,"X"),s.qZA()}}function g(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",39),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().index;return s.oxw(2).deleteTab(e)}),s._uU(1,"X"),s.qZA()}}function f(t,e){if(1&t&&(s.TgZ(0,"article",30),s.TgZ(1,"article",31),s.TgZ(2,"article",32),s.TgZ(3,"label",33),s._uU(4,"Tab name"),s.qZA(),s._UZ(5,"input",34),s.qZA(),s.TgZ(6,"article",35),s.TgZ(7,"label",36),s._uU(8,"Tab order"),s.qZA(),s._UZ(9,"input",37),s.qZA(),s.YNc(10,h,2,0,"button",38),s.YNc(11,g,2,0,"button",38),s.qZA(),s.qZA()),2&t){const t=e.index,n=s.oxw(2);s.Q6J("formGroupName",t),s.xp6(10),s.Q6J("ngIf",!n.editMode),s.xp6(1),s.Q6J("ngIf",n.editMode&&n.currnetCompany.tabs.length<t+1)}}function y(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"section",17),s.TgZ(1,"article",18),s.TgZ(2,"form",19),s.NdJ("ngSubmit",function(){s.CHM(t);const e=s.oxw();return e.editMode?e.saveChanges(e.addCompanyForm):e.addCompany(e.addCompanyForm)}),s.TgZ(3,"article",20),s.TgZ(4,"label",21),s._uU(5,"Company name"),s.qZA(),s._UZ(6,"input",22),s.qZA(),s.TgZ(7,"article",23),s.YNc(8,f,12,3,"article",24),s.qZA(),s.TgZ(9,"article",25),s.TgZ(10,"button",26),s.NdJ("click",function(){return s.CHM(t),s.oxw().addNewTab()}),s._uU(11,"Add tab"),s.qZA(),s.qZA(),s.TgZ(12,"article",27),s.TgZ(13,"button",28),s._uU(14),s.qZA(),s.TgZ(15,"button",29),s.NdJ("click",function(){return s.CHM(t),s.oxw().cancelCompanyForm()}),s._uU(16,"Cancel"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(2),s.Q6J("formGroup",t.addCompanyForm),s.xp6(6),s.Q6J("ngForOf",t.getControls()),s.xp6(5),s.Q6J("disabled",t.addCompanyForm.invalid),s.xp6(1),s.Oqu(t.editMode?"Save Changes":"Add Compay")}}function Z(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1,"company "),s.TgZ(2,"span",45),s._uU(3),s.qZA(),s.qZA()),2&t){const t=s.oxw(2);s.xp6(3),s.Oqu(t.currnetCompany.name)}}function C(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1,"tab "),s.TgZ(2,"span",45),s._uU(3),s.qZA(),s._uU(4," of company "),s.TgZ(5,"span",45),s._uU(6),s.qZA(),s.qZA()),2&t){const t=s.oxw(2);s.xp6(3),s.Oqu(t.currentTabName),s.xp6(3),s.Oqu(t.currnetCompany.name)}}function T(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"section",40),s.TgZ(1,"article",41),s.TgZ(2,"article",42),s.TgZ(3,"p"),s._uU(4,"Are you sure you want to delete "),s.YNc(5,Z,4,1,"span",5),s.YNc(6,C,7,2,"span",5),s._uU(7,"? "),s.qZA(),s.TgZ(8,"article",43),s.TgZ(9,"button",44),s.NdJ("click",function(){s.CHM(t);const e=s.oxw();return"company"==e.deleteParameter?e.deleteCompany():e.deleteCompanyTab()}),s._uU(10,"Delete"),s.qZA(),s.TgZ(11,"button",44),s.NdJ("click",function(){return s.CHM(t),s.oxw().resetDeletePopup()}),s._uU(12,"Cancel"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(5),s.Q6J("ngIf","company"==t.deleteParameter),s.xp6(1),s.Q6J("ngIf","tab"==t.deleteParameter)}}let _=(()=>{class t{constructor(t,e){this._firestore=t,this._generateId=e,this.showCompanyForm=!1,this.companies=[],this.companyTabs=new r.Oe([new r.cw({tabName:new r.NI(null,r.kI.required),tabOrder:new r.NI(null,[r.kI.required,r.kI.pattern(/^[1-9]+[1-9]*$/)])})]),this.isInEditMode=!1,this.editMode=!1,this.deletePopup=!1,this.deleteParameter="",this.currentTabName="",this.currnetCompany=[],this.currentTabId="",this.currentTabIds=[],this.shownOptions=""}ngOnInit(){this.addCompanyForm=new r.cw({name:new r.NI(null,r.kI.required),tabs:this.companyTabs}),this._companiesSubscription=this._firestore.companiesSubject.subscribe(t=>{this.companies=t})}ngOnDestroy(){this._companiesSubscription.unsubscribe()}addCompany(t){if(this.addCompanyForm.invalid)return;const e=this._generateId.generateId(),n=t.value.name,a=i.Z.firestore.Timestamp.now(),o=t.value.tabs;this._firestore.addCompany(e,{name:n,date:a}).then(()=>{0==o.length&&this.resetCompanyForm(o.length),new Promise(t=>{for(let n=0;n<o.length;n++){const a=this._generateId.generateId();this._firestore.addCompanyTabs(e,a,{tabName:o[n].tabName,tabOrder:o[n].tabOrder,tabDescription:"<p></p>"}).then(()=>{n==o.length-1&&t()})}}).then(()=>{this.resetCompanyForm(o.length)})})}saveChanges(t){if(this.addCompanyForm.invalid)return;const e=this.currnetCompany.id,n={id:e,name:t.value.name},a=t.value.tabs;if(0==this.currentTabIds.length)for(let o=0;o<a.length;o++){const t=this._generateId.generateId();this._firestore.addCompanyTabs(e,t,{tabName:a[o].tabName,tabOrder:a[o].tabOrder,tabDescription:"<p></p>"}).then(()=>{o==a.length-1&&(this.resetCompanyForm(a.length),this.currnetCompany=[],this.currentTabIds=[])})}this._firestore.editCompany(e,n).then(()=>{new Promise(t=>{for(let n=0;n<this.currentTabIds.length;n++)this._firestore.editCompanyTabs(e,this.currentTabIds[n],{tabName:a[n].tabName,tabOrder:a[n].tabOrder}).then(()=>{n==this.currentTabIds.length-1&&t()})}).then(()=>{if(this.currentTabIds.length==a.length)return this.resetCompanyForm(a.length),this.currnetCompany=[],void(this.currentTabIds=[]);new Promise(t=>{for(let n=this.currentTabIds.length;n<a.length;n++){const o=this._generateId.generateId();this._firestore.addCompanyTabs(e,o,{tabName:a[n].tabName,tabOrder:a[n].tabOrder,tabDescription:"<p></p>"}).then(()=>{n==a.length-1&&t()})}}).then(()=>{this.resetCompanyForm(a.length),this.currnetCompany=[],this.currentTabIds=[]})})})}cancelCompanyForm(){this.resetCompanyForm(this.addCompanyForm.value.tabs.length),this.currnetCompany=[],this.currentTabIds=[]}addNewTab(){this.addCompanyForm.get("tabs").push(new r.cw({tabName:new r.NI(null,r.kI.required),tabOrder:new r.NI(null,[r.kI.required,r.kI.pattern(/^[1-9]+[1-9]*$/)])}))}deleteTab(t){this.companyTabs.removeAt(t)}getControls(){return this.addCompanyForm.get("tabs").controls}resetCompanyForm(t){this.showCompanyForm=!1,this.editMode=!1,this.addCompanyForm.reset();for(let e=1;e<t;e++)this.deleteTab(1)}confirmToDelete(t,e,n,a){this.currnetCompany=e,this.currentTabName=a,this.deletePopup=!0,this.currentTabId=n,this.deleteParameter="company"==t?"company":"tab"}deleteCompany(){localStorage.getItem("company")==this.currnetCompany.id&&(localStorage.removeItem("company"),localStorage.removeItem("tab")),0==this.currnetCompany.tabs.length&&this._firestore.deleteCompany(this.currnetCompany.id).then(()=>{this.resetDeletePopup()}),new Promise(t=>{for(let e=0;e<this.currnetCompany.tabs.length;e++)this._firestore.deleteCompanyTab(this.currnetCompany.id,this.currnetCompany.tabs[e].id).then(()=>{0==this.currnetCompany.tabs.length&&t()})}).then(()=>{this._firestore.deleteCompany(this.currnetCompany.id).then(()=>{this.resetDeletePopup()})})}deleteCompanyTab(){this._firestore.deleteCompanyTab(this.currnetCompany.id,this.currentTabId).then(()=>{localStorage.getItem("tab")==this.currentTabId&&this.currnetCompany.tabs.length>0&&localStorage.setItem("tab",this.currnetCompany.tabs[0].id),this.resetDeletePopup()})}resetDeletePopup(){this.deletePopup=!1,this.deleteParameter="",this.currentTabName="",this.currnetCompany=[],this.currentTabId=""}edit(t){this.deleteTab(0),this.currnetCompany=t,this.addCompanyForm.controls.name.setValue(t.name);for(let e=0;e<t.tabs.length;e++)this.currentTabIds.push(t.tabs[e].id),this.addCompanyForm.get("tabs").push(new r.cw({tabName:new r.NI(t.tabs[e].tabName,r.kI.required),tabOrder:new r.NI(t.tabs[e].tabOrder,[r.kI.required,r.kI.pattern(/^[1-9]+[1-9]*$/)])}));this.editMode=!0}deleteOptions(t){this.isInEditMode=!this.isInEditMode,this.shownOptions=this.isInEditMode?t:""}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(c.C),s.Y36(d))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-manage-companies"]],decls:11,vars:6,consts:[[1,"container"],[1,"company-bts"],[1,"btn","green-btn","company-bts__addcompany",3,"click"],[1,"btn","red-btn",3,"ngClass","click"],["class","companies",4,"ngFor","ngForOf"],[4,"ngIf"],["class","add-company-section",4,"ngIf"],["class","delete-section",4,"ngIf"],[1,"companies"],[1,"companies__company"],["class","btn red-btn cross-btn",3,"click",4,"ngIf"],[1,"companies__tabs"],["class","companies__tabs__tab",4,"ngFor","ngForOf"],[1,"companies__edit"],[1,"btn","green-btn",3,"click"],[1,"btn","red-btn","cross-btn",3,"click"],[1,"companies__tabs__tab"],[1,"add-company-section"],[1,"add-company-section__wrapper"],[1,"add-company-form",3,"formGroup","ngSubmit"],[1,"add-company-form__name"],["for","name"],["type","text","name","name","formControlName","name"],["formArrayName","tabs",1,"add-company-form__tabs"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"add-company-form__add-tab-btn"],["type","button",1,"btn","green-btn",3,"click"],[1,"add-company-form__control-btns"],["type","submit",1,"btn","green-btn",3,"disabled"],["type","button",1,"btn","red-btn",3,"click"],[3,"formGroupName"],[1,"add-company-form__tabs__tab"],[1,"tab-name"],["for","tab"],["type","text","name","tabName","formControlName","tabName"],[1,"tab-order"],["for","order"],["type","number","name","tabOrder","formControlName","tabOrder"],["class","btn red-btn tab-btn",3,"click",4,"ngIf"],[1,"btn","red-btn","tab-btn",3,"click"],[1,"delete-section"],[1,"delete-section__wrapper"],[1,"delete-popup"],[1,"delete-popup__btns"],[1,"btn","red-btn",3,"click"],[1,"delete-popup__red-text"]],template:function(t,e){1&t&&(s.TgZ(0,"section"),s.TgZ(1,"article",0),s.TgZ(2,"article",1),s.TgZ(3,"button",2),s.NdJ("click",function(){return e.showCompanyForm=!0}),s._uU(4,"Add new company"),s.qZA(),s.TgZ(5,"button",3),s.NdJ("click",function(){return e.isInEditMode=!e.isInEditMode}),s._uU(6),s.qZA(),s.qZA(),s.YNc(7,l,10,3,"article",4),s.YNc(8,b,3,0,"article",5),s.qZA(),s.qZA(),s.YNc(9,y,17,4,"section",6),s.YNc(10,T,13,2,"section",7)),2&t&&(s.xp6(5),s.Q6J("ngClass",e.isInEditMode?"pressed":""),s.xp6(1),s.hij("",e.isInEditMode?"Disable":"Enable"," Delete Buttons"),s.xp6(1),s.Q6J("ngForOf",e.companies),s.xp6(1),s.Q6J("ngIf",0==(null==e.companies?null:e.companies.length)),s.xp6(1),s.Q6J("ngIf",e.showCompanyForm||e.editMode),s.xp6(1),s.Q6J("ngIf",e.deletePopup))},directives:[a.mk,a.sg,a.O5,r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,r.CE,r.x0,r.wV],encapsulation:2}),t})();var I=n(4722);let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[a.ez,r.UX,o.Bz.forChild([{path:"",component:_,canActivate:[I.D]}])]]}),t})()}}]);